services:
  mcp4j-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: bb-mcp4j-server
    ports:
      - "9000:9000"
    environment:
      # Server Configuration
      - MCP_SERVER_HOST=0.0.0.0
      - MCP_SERVER_PORT=9000
      - MCP_SERVER_DEBUG=false
      - MCP_SERVER_SERVER_NAME=BBMCPServer
      
      # Authentication (optional - uncomment to enable)
      - MCP_SERVER_ENABLE_AUTH=false
      # - MCP_SERVER_TENANT_ID=${TENANT_ID}
      # - MCP_SERVER_CLIENT_ID=${CLIENT_ID}
      # - MCP_SERVER_JWKS_URI=${JWKS_URI}
      # - MCP_SERVER_ISSUER=${ISSUER}
      # - MCP_SERVER_AUDIENCE=${AUDIENCE}
      
      # Java Options
      - JAVA_OPTS=-Xmx512m -Xms256m
    
    volumes:
      # Mount application.properties if you want to override config
      # - ./application.properties:/app/config/application.properties:ro
      # Mount user data directory
      - ./user:/app/user:rw
    
    restart: unless-stopped
    
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:9000/api/mcp/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    
    networks:
      - mcp-network

networks:
  mcp-network:
    driver: bridge
